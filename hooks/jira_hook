#!/usr/bin/env python3

import requests
import configparser
import os

from jira import JiraHook, JiraLogin, JiraLogout, JiraAddComment

session = requests.Session()
config = configparser.ConfigParser()

config.read(os.path.expanduser('~/gerrit_hook.config'))
jira_config = config['jira']

jira_hook = JiraHook(jira_config['url'])
jira_hook.appendJiraCommand(command=JiraLogin(session, jira_config['username'], jira_config['password']))
jira_hook.appendJiraCommand(command=JiraAddComment(session, 'TEST-1', 'This is a test'))
jira_hook.appendJiraCommand(command=JiraLogout(session))
jira_hook.execute()
